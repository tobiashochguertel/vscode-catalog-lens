#!/usr/bin/env bash

# Husky v9 commit-msg hook
# Validates commit messages using commitlint

# Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo "${BLUE}üìù Validating commit message...${NC}"

# Run commitlint
npx --no -- commitlint --edit "$1"

if [ $? -ne 0 ]; then
  echo
  echo "${RED}‚ùå Commit message validation failed!${NC}"
  echo
  echo "${YELLOW}üí° Commit message must follow Conventional Commits format:${NC}"
  echo "${YELLOW}   <type>(<scope>): <description>${NC}"
  echo
  echo "${YELLOW}Examples:${NC}"
  echo "  feat(catalog): add support for Bun workspaces"
  echo "  fix(parser): handle edge case in YAML parsing"
  echo "  docs: update README with installation steps"
  echo "  chore(deps): update dependencies"
  echo
  echo "${YELLOW}Valid types:${NC}"
  echo "  feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert"
  echo
  echo "${YELLOW}For breaking changes, add '!' before the colon:${NC}"
  echo "  feat!: remove deprecated API"
  echo
  exit 1
fi

echo "${GREEN}‚úì Commit message validated${NC}"
